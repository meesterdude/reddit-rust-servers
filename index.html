<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Reddit-rust-servers by meesterdude</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <link rel="stylesheet" href="stylesheets/jquery.dataTables.css">
    <link rel="stylesheet" href="stylesheets/jquery.dataTables_themeroller.css">
    <link rel="stylesheet" href="stylesheets/jquery-ui.css">
    <link rel="stylesheet" href="stylesheets/colvis.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <script src="javascripts/jquery.js"></script>
    <script src="javascripts/jquery.dataTables.js"></script>
    <script src="javascripts/ColVis.min.js"></script>
    <script src="javascripts/underscore_strings.js"></script>

    <script src="javascripts/jquery.dataTables.columnFilter.js"></script>



    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  </head>
  <body>
      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/meesterdude/reddit-rust-servers">View On GitHub</a></li>
          <li class="downloads"><a href="https://github.com/meesterdude/reddit-rust-servers/zipball/master">ZIP</a></li>
          <li class="downloads"><a href="https://github.com/meesterdude/reddit-rust-servers/tarball/master">TAR</a></li>
          <li class="title">DOWNLOADS</li>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>Reddit-rust-servers</h1>
          <p>Uses a <a href="servers.json">JSON source</a> to dynamically render a highly searchable table. The JSON is scraped from /r/playrustservers posts with the (JAD) tag. Want to see your server here? <a href="http://reddit.com/r/playrustservers/wiki/jad">checkout the wiki post</a></p>
        </div>
      </section>
    </div>
    <section class='table'>
      <p>When using range filters, you may need to display all columns</p>
    <table width="100%" cellpadding="0" cellspacing="0" border="0" class="display" id="main">
      <thead>
        <tr></tr>
      </thead>
      <tbody>
      </tbody>
        <tfoot>
        <tr>
        </tr>
      </tfoot>
    </table>
  </section>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

  </body>

     <script type="text/javascript">
    $(document).ready(function() {


      headers = ["name", "ip:port", "_post", "about", "post-author", "location", "donations", "pvp", "beginner-friendly", "seeking-admins", "reddit-contact-user", "has-voice-server", "crafting-time-percent","slots", "admin-power-usage", "admin-usernames", "sleepers", "airdrop-min-players", "mini-games", "site", "forum", "server-launched", "entry-updated"]

      hide_cols = ["about", "donations", "admin-usernames", "post-author", "server-launched", "entry-updated","site", "forum", "mini-games", "_post","reddit-contact-user", "has-voice-server", "seeking-admins", "airdrop-min-players"]
      rows = new Array()
      $.getJSON("./servers.json?33", function(data){
        $.each(data.servers, function(i,server){
          var row = []
          $.each(headers, function(index, val){
            row.push(server[val] || '-')
          })
          rows.push(row);
        });
        $.each(headers, function(i, header){
          var human_header = _.str.humanize(header)
          $('#main thead tr').append("<th>" + human_header + "</th>")
          $('#main tfoot tr').append("<th>" + human_header + "</th>")
        });
        $.each(rows, function(i,row){
          content_row = "<tr>"
          $.each(row, function(pos,val){
            if (_.str.startsWith(val, "http")) {
              val = "<a href='" + val +"' title='" + val + "'>Visit</a>"
            }

            content_row +="<td>" + val + "</td>"
          });
          content_row += "</tr>"
          $('#main tbody').append(content_row);
        });

        var oTable = $('#main').dataTable(
          {
            "sDom": 'RC<"clear">lfrtip',
          }).columnFilter({
            //TODO: make part of headers
            aoColumns: [
              {type: "text"},
              {type: "text"},
              {type: "text"},
              {type: "text"},
              {type: "text"},
              {type: "select"},
              {type: "select"},
              {type: "select"},
              {type: "select"},
              {type: "select"},
              {type: "text"},
              {type: "select"},
              {type: "number-range"},
              {type: "number-range"},
              {type: "select"},
              {type: "text"},
              {type: "select"},
              {type: "number-range"},
              {type: "select"},
              {type: "text"},
              {type: "text"},
              null,
              null
            ]
        });
        // hack to hide columns
        $("button.ColVis_MasterButton").trigger("click");
        $.each(hide_cols, function(i, col){
          $("button.TableTools_Button:contains(" + _.str.humanize(col) + ")").click();

        });
      });
    });
   </script>
</html>